
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Combinator Constructors &#8212; OpenDP</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Transformation Constructors" href="transformation-constructors.html" />
    <link rel="prev" title="Supporting Elements" href="supporting-elements.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="None">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    <img src="../_static/opendp-logo.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/opendp-logo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../quickstart.html">
  Quickstart
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../examples.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api/index.html">
  API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../more.html">
  More…
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../contact.html">
  Contact
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/opendp" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/opendp_org" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/opendp/opendp/discussions" rel="noopener" target="_blank" title="GitHub Discussions"><span><i class="far fa-comments"></i></span>
            <label class="sr-only">GitHub Discussions</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="limitations.html">
   Limitations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="getting-started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="programming-framework.html">
   Programming Framework
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="core-structures.html">
   Core Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="supporting-elements.html">
   Supporting Elements
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Combinator Constructors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="transformation-constructors.html">
   Transformation Constructors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="measurement-constructors.html">
   Measurement Constructors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="application-structure.html">
   Application Structure
  </a>
 </li>
</ul>

  </div>
</nav>
<h6>Branches</h6>
<ul>
    <li><a href="combinator-constructors.html" style="font-weight: bold">latest</a></li>
    <li><a href="../../stable/user/combinator-constructors.html" style="font-weight: normal">stable</a></li>
</ul>


<h6 id="releases_header">Releases
    <div id="releases_symbol" style="float:right"></div>
</h6>
<ul id="releases_content">
    <li><a href="../../v0.4.0/user/combinator-constructors.html" style="font-weight: normal">v0.4.0</a></li>
    <li><a href="../../v0.4.0-rc.4/user/combinator-constructors.html" style="font-weight: normal">v0.4.0-rc.4</a></li>
    <li><a href="../../v0.4.0-rc.3/user/combinator-constructors.html" style="font-weight: normal">v0.4.0-rc.3</a></li>
    <li><a href="../../v0.4.0-rc.2/user/combinator-constructors.html" style="font-weight: normal">v0.4.0-rc.2</a></li>
    <li><a href="../../v0.4.0-rc.1/user/combinator-constructors.html" style="font-weight: normal">v0.4.0-rc.1</a></li>
    <li><a href="../../v0.3.0/user/combinator-constructors.html" style="font-weight: normal">v0.3.0</a></li>
    <li><a href="../../v0.3.0-rc.3/user/combinator-constructors.html" style="font-weight: normal">v0.3.0-rc.3</a></li>
    <li><a href="../../v0.3.0-rc.2/user/combinator-constructors.html" style="font-weight: normal">v0.3.0-rc.2</a></li>
    <li><a href="../../v0.3.0-rc.1/user/combinator-constructors.html" style="font-weight: normal">v0.3.0-rc.1</a></li>
    <li><a href="../../v0.2.4/user/combinator-constructors.html" style="font-weight: normal">v0.2.4</a></li>
    <li><a href="../../v0.2.3/user/combinator-constructors.html" style="font-weight: normal">v0.2.3</a></li>
    <li><a href="../../v0.2.2/user/combinator-constructors.html" style="font-weight: normal">v0.2.2</a></li>
    <li><a href="../../v0.2.2-rc.1/user/combinator-constructors.html" style="font-weight: normal">v0.2.2-rc.1</a></li>
    <li><a href="../../v0.2.1/index.html" style="font-weight: normal">v0.2.1</a></li>
    <li><a href="../../v0.2.1-rc.1/index.html" style="font-weight: normal">v0.2.1-rc.1</a></li>
    <li><a href="../../v0.2.0-rc1/index.html" style="font-weight: normal">v0.2.0-rc1</a></li>
    <li><a href="../../v0.2.0/index.html" style="font-weight: normal">v0.2.0</a></li>
    <li><a href="../../v0.2.0-rc.6/index.html" style="font-weight: normal">v0.2.0-rc.6</a></li>
    <li><a href="../../v0.2.0-rc.5/index.html" style="font-weight: normal">v0.2.0-rc.5</a></li>
    <li><a href="../../v0.2.0-rc.4/index.html" style="font-weight: normal">v0.2.0-rc.4</a></li>
    <li><a href="../../v0.2.0-rc.3/index.html" style="font-weight: normal">v0.2.0-rc.3</a></li>
    <li><a href="../../v0.2.0-rc.2/index.html" style="font-weight: normal">v0.2.0-rc.2</a></li>
    <li><a href="../../v0.1.0/index.html" style="font-weight: normal">v0.1.0</a></li>
    <li><a href="../../v0.1.0-rc.8/index.html" style="font-weight: normal">v0.1.0-rc.8</a></li>
    <li><a href="../../v0.1.0-rc.7/index.html" style="font-weight: normal">v0.1.0-rc.7</a></li>
    <li><a href="../../v0.1.0-rc.6/index.html" style="font-weight: normal">v0.1.0-rc.6</a></li>
    <li><a href="../../v0.1.0-rc.5/index.html" style="font-weight: normal">v0.1.0-rc.5</a></li>
    <li><a href="../../v0.1.0-rc.4/index.html" style="font-weight: normal">v0.1.0-rc.4</a></li>
    <li><a href="../../v0.1.0-rc.3/index.html" style="font-weight: normal">v0.1.0-rc.3</a></li>
    <li><a href="../../v0.1.0-rc.2/index.html" style="font-weight: normal">v0.1.0-rc.2</a></li>
    <li><a href="../../v0.1.0-rc.1/index.html" style="font-weight: normal">v0.1.0-rc.1</a></li>
</ul>
<script>
    let expanded = !!JSON.parse(localStorage.getItem('expanded'));

    let releasesHeader = document.getElementById("releases_header");
    let releasesSymbol = document.getElementById("releases_symbol");
    let releasesContent = document.getElementById("releases_content");

    function setReleasesState() {
        localStorage.setItem("expanded", JSON.stringify(expanded))
        releasesContent.style.display = expanded ? "block" : "none";
        releasesSymbol.classList.add(expanded ? 'minus' : 'plus')
        releasesSymbol.classList.remove(expanded ? 'plus' : 'minus')
    }

    setReleasesState()
    releasesHeader.addEventListener("click", function() {
        expanded = !expanded;
        setReleasesState()
    })
</script>
<style>
    .plus {
        position: relative;
        width:20px;
        height:20px;
        background:#676767;
    }

    .plus:before,
    .plus:after {
        content: "";
        position:absolute;
        background:#fff;
    }

    .plus:before {
        left:50%;
        top:4px;
        bottom:4px;
        width:3px;
        transform:translateX(-50%);
    }

    .plus:after {
        top:50%;
        left:4px;
        right:4px;
        height:3px;
        transform:translateY(-50%);
    }



    .minus {
        position: relative;
        width:20px;
        height:20px;
        background:#676767;
    }

    .minus:before,
    .minus:after {
        content: "";
        position:absolute;
        background:#fff;
    }

    .minus:after {
        top:50%;
        left:4px;
        right:4px;
        height:3px;
        transform:translateY(-50%);
    }
</style>

  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chaining">
   Chaining
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#composition">
   Composition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#amplification">
   Amplification
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="combinator-constructors">
<span id="id1"></span><h1>Combinator Constructors<a class="headerlink" href="#combinator-constructors" title="Permalink to this headline">#</a></h1>
<p>Combinator constructors use transformations or measurements to produce new transformations or measurements.
Combinators are an area of OpenDP that are still heavily in development,
but the chainers in particular are foundational and well-tested.</p>
<section id="chaining">
<span id="id2"></span><h2>Chaining<a class="headerlink" href="#chaining" title="Permalink to this headline">#</a></h2>
<p>Two of the most essential constructors are the “chainers” that chain transformations with transformations, and transformations with measurements.
Chainers are used to incrementally piece Transformations or Measurements together that represent longer computational pipelines.</p>
<p>The <a class="reference internal" href="../api/python/opendp.comb.html#opendp.comb.make_chain_tt" title="opendp.comb.make_chain_tt"><code class="xref py py-func docutils literal notranslate"><span class="pre">opendp.comb.make_chain_tt()</span></code></a> constructor creates a new Transformation by combining an inner and an outer Transformation.
The resulting Transformation contains a function that sequentially executes the function of the constituent Transformations.
It also contains a privacy relation that relates an input distance bound on the inner Transformation with an output distance bound on the outer transformation.</p>
<p>The <a class="reference internal" href="../api/python/opendp.comb.html#opendp.comb.make_chain_mt" title="opendp.comb.make_chain_mt"><code class="xref py py-func docutils literal notranslate"><span class="pre">opendp.comb.make_chain_mt()</span></code></a> constructor similarly creates a new Measurement by combining an inner Transformation with an outer Measurement.
Notice that <cite>there is no</cite> <code class="docutils literal notranslate"><span class="pre">make_chain_mm</span></code> for chaining measurements together!
Any computation beyond a measurement is postprocessing and need not be governed by relations.</p>
<p>In the following example we chain <a class="reference internal" href="../api/python/opendp.meas.html#opendp.meas.make_base_geometric" title="opendp.meas.make_base_geometric"><code class="xref py py-func docutils literal notranslate"><span class="pre">opendp.meas.make_base_geometric()</span></code></a> with <a class="reference internal" href="../api/python/opendp.trans.html#opendp.trans.make_bounded_sum" title="opendp.trans.make_bounded_sum"><code class="xref py py-func docutils literal notranslate"><span class="pre">opendp.trans.make_bounded_sum()</span></code></a>.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">opendp.trans</span> <span class="kn">import</span> <span class="n">make_bounded_sum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">opendp.meas</span> <span class="kn">import</span> <span class="n">make_base_geometric</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">opendp.comb</span> <span class="kn">import</span> <span class="n">make_chain_mt</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># call a constructor to produce a transformation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounded_sum</span> <span class="o">=</span> <span class="n">make_bounded_sum</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># call a constructor to produce a measurement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_geometric</span> <span class="o">=</span> <span class="n">make_base_geometric</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noisy_sum</span> <span class="o">=</span> <span class="n">make_chain_mt</span><span class="p">(</span><span class="n">base_geometric</span><span class="p">,</span> <span class="n">bounded_sum</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># investigate the privacy relation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symmetric_distance</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">noisy_sum</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">d_in</span><span class="o">=</span><span class="n">symmetric_distance</span><span class="p">,</span> <span class="n">d_out</span><span class="o">=</span><span class="n">epsilon</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># invoke the chained measurement&#39;s function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">release</span> <span class="o">=</span> <span class="n">noisy_sum</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
<p>In practice, these chainers are used so frequently that we’ve written a shorthand (<code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code>).
The syntax automatically chooses between <code class="xref py py-func docutils literal notranslate"><span class="pre">make_chain_mt</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">make_chain_tt</span></code>.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">noisy_sum</span> <span class="o">=</span> <span class="n">bounded_sum</span> <span class="o">&gt;&gt;</span> <span class="n">base_geometric</span>
</pre></div>
</div>
<p id="chaining-mismatch">In this example the chaining was successful because:</p>
<ul class="simple">
<li><p>bounded_sum’s output domain is equivalent to base_geometric’s input domain</p></li>
<li><p>bounded_sum’s output metric is equivalent to base_geometric’s input metric</p></li>
</ul>
<p>Chaining fails if we were to adjust the domains such that they won’t match.
In the below example, the adjustment is subtle, but the bounds were adjusted to floats.
<code class="docutils literal notranslate"><span class="pre">make_bounded_sum</span></code> is equally capable of summing floats,
but the chaining fails because the sum emits floats and the geometric mechanism expects integers.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">opendp.mod</span> <span class="kn">import</span> <span class="n">OpenDPException</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">make_bounded_sum</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="n">base_geometric</span>
<span class="gp">... </span><span class="k">except</span> <span class="n">OpenDPException</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">message</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Intermediate domains don&#39;t match. See https://github.com/opendp/opendp/discussions/297</span>
<span class="go">    output_domain: AllDomain(f64)</span>
<span class="go">    input_domain:  AllDomain(i32)</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">noisy_sum</span></code>’s input domain and input metric come from <code class="docutils literal notranslate"><span class="pre">bounded_sum</span></code>’s input domain and input metric.
This is intended to enable further chaining with preprocessors like <a class="reference internal" href="../api/python/opendp.trans.html#opendp.trans.make_cast" title="opendp.trans.make_cast"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_cast</span></code></a>, <a class="reference internal" href="../api/python/opendp.trans.html#opendp.trans.make_impute_constant" title="opendp.trans.make_impute_constant"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_impute_constant</span></code></a>, <a class="reference internal" href="../api/python/opendp.trans.html#opendp.trans.make_clamp" title="opendp.trans.make_clamp"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_clamp</span></code></a> and <a class="reference internal" href="../api/python/opendp.trans.html#opendp.trans.make_bounded_resize" title="opendp.trans.make_bounded_resize"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_bounded_resize</span></code></a>.
See the section on <a class="reference internal" href="transformation-constructors.html#transformation-constructors"><span class="std std-ref">Transformation Constructors</span></a> for more information on how to preprocess data in OpenDP.</p>
</section>
<section id="composition">
<h2>Composition<a class="headerlink" href="#composition" title="Permalink to this headline">#</a></h2>
<p>OpenDP has a basic composition combinator for composing a list of measurements into a new measurement.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">opendp.comb</span> <span class="kn">import</span> <span class="n">make_basic_composition</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noisy_sum_pair</span> <span class="o">=</span> <span class="n">make_basic_composition</span><span class="p">([</span><span class="n">noisy_sum</span><span class="p">,</span> <span class="n">noisy_sum</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="amplification">
<h2>Amplification<a class="headerlink" href="#amplification" title="Permalink to this headline">#</a></h2>
<p>If your dataset is a simple sample from a larger population,
you can make the privacy relation more permissive by wrapping your measurement with a privacy amplification combinator.</p>
<p>In order to demonstrate this API, we’ll first create a measurement with a sized input domain.
The resulting measurement expects the size of the input dataset to be 10.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">opendp.trans</span> <span class="kn">import</span> <span class="n">make_sized_bounded_mean</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">opendp.meas</span> <span class="kn">import</span> <span class="n">make_base_laplace</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meas</span> <span class="o">=</span> <span class="n">make_sized_bounded_mean</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="n">make_base_laplace</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;standard mean:&quot;</span><span class="p">,</span> <span class="n">amplified</span><span class="p">([</span><span class="mf">1.</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="p">))</span> <span class="c1"># -&gt; 1.03 </span>
</pre></div>
</div>
<p>We can now use the amplification combinator to construct an amplified measurement.
The function on the amplified measurement is identical to the standard measurement.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">opendp.comb</span> <span class="kn">import</span> <span class="n">make_population_amplification</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amplified</span> <span class="o">=</span> <span class="n">make_population_amplification</span><span class="p">(</span><span class="n">meas</span><span class="p">,</span> <span class="n">population_size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;amplified mean:&quot;</span><span class="p">,</span> <span class="n">amplified</span><span class="p">([</span><span class="mf">1.</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="p">))</span> <span class="c1"># -&gt; .97 </span>
</pre></div>
</div>
<p>The privacy relation on the amplified measurement takes into account that the input dataset of size 10
is a simple sample of individuals from a theoretical larger dataset that captures the entire population, with 100 rows.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Where we once had a privacy utilization of ~2 epsilon...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">meas</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">2.</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ...we now have a privacy utilization of ~.4941 epsilon.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">amplified</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">.4941</span><span class="p">)</span>
</pre></div>
</div>
<p>The efficacy of this combinator improves as n gets larger.</p>
</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="supporting-elements.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Supporting Elements</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="transformation-constructors.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Transformation Constructors</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.1.2.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>